{% extends 'core/base.html' %}
{% load static %}
{% block content %}
<h1>Edit Bill</h1>
<div class="container">
    <div class="row">
        <!-- Full-width Form -->
        <div class="col-md-12">
            <h3>Edit Bill Details</h3>
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
            <form method="POST" enctype="multipart/form-data" id="edit-form">
                {% csrf_token %}
                <input type="hidden" name="bill_id" value="{{ bill.id }}">
                <div class="mb-3">
                    <label for="id_bill_image" class="form-label">Bill Image (Optional - Upload to Replace)</label>
                    <input type="file" name="bill_image" id="id_bill_image" class="form-control" accept=".jpg,.jpeg,.png">
                    <small class="form-text text-muted">Max file size: 5MB (JPG/PNG). Leave empty to keep current image.</small>
                </div>
                <div class="mb-3">
                    <label for="id_warranty_image" class="form-label">Warranty Card Image (Optional - Upload to Replace)</label>
                    <input type="file" name="warranty_image" id="id_warranty_image" class="form-control" accept=".jpg,.jpeg,.png">
                    <small class="form-text text-muted">Max file size: 5MB (JPG/PNG). Leave empty to keep current image.</small>
                </div>
                <div class="mb-3">
                    <label for="id_shop_name" class="form-label">Shop Name</label>
                    <input type="text" name="shop_name" id="id_shop_name" class="form-control" value="{{ form.shop_name.value|default:'' }}" placeholder="Enter shop name" required>
                </div>
                <div class="mb-3">
                    <label for="id_contact_number" class="form-label">Contact Number</label>
                    <input type="text" name="contact_number" id="id_contact_number" class="form-control" value="{{ form.contact_number.value|default:'' }}" placeholder="Enter contact number" required>
                </div>
                <div class="mb-3">
                    <label for="id_bill_date" class="form-label">Bill Date</label>
                    <input type="date" name="bill_date" id="id_bill_date" class="form-control" value="{{ form.bill_date.value|date:'Y-m-d'|default:'' }}" placeholder="YYYY-MM-DD" required>
                </div>
                <div class="mb-3">
                    <label for="id_total_amount" class="form-label">Total Amount</label>
                    <input type="number" step="0.01" name="total_amount" id="id_total_amount" class="form-control" value="{{ form.total_amount.value|default:0 }}" placeholder="0.0" required>
                </div>
                <div class="mb-3">
                    <label for="id_items" class="form-label">Items</label>
                    <textarea name="items" id="id_items" class="form-control" rows="3" placeholder="Enter items" required>{{ form.items.value|default:'' }}</textarea>
                </div>
                <div class="mb-3">
                    <label for="id_warranty_period_years" class="form-label">Warranty Period (Years)</label>
                    <input type="number" name="warranty_period_years" id="id_warranty_period_years" class="form-control" value="{{ form.warranty_period_years.value|default:0 }}" placeholder="0" required>
                </div>
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </form>
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('edit-form');
        
        form.addEventListener('submit', (e) => {
            // Let the form submit normally
            // The server will handle the redirect
        });
    });
</script>
{% endblock %}